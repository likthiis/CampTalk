# CampTalk前后端交互文档




---

CampTalk是一个基本动画"摇曳露营"的动漫元素设计而成的聊天软件，面向所有的动漫爱好者和露营爱好者进行服务。本应用目前开放了IOS端供大家使用，还请大家多多支持！您可以使用CampTalk：

> * 寻找并添加好友，进行聊天
> * 发布自己的旅游照片和所见所闻

---

##设计蓝图
###接口说明
####0.事先说明
服务端再返回数据时统一用一个结构体写成JSON格式传回客户端，该结构体的内容如下代码所示例：
```
{
    "code": "OK",
    "timestamp": "2018-05-11 18:44:54",
    "returnElement": {
        "sign": null,
        "message": null,
        "data": "#wrong_password"
    }
}
```
具体参数描述
| 参数名         | 必选   | 类型  |说明                  |
| :------------: | :-----:| :----:|:--------------------:|
|code            | yes    |String |说明处理结果的大体情况|
|timestamp       | yes    |String |时间戳                |
|returnElement   | yes    |String |返回具体的数据        |

returnElement作为内层JSON存在，其具体参数如下
| 参数名         | 必选   | 类型  |说明                  |
| :------------: | :-----:| :----:|:--------------------:|
|sign            | yes    |String |                      |
|message         | yes    |String |                      |
|data            | yes    |String |记录具体的处理结果    |
####1.登录
#####具体描述
用户登录
#####流程描述
用户输入用户名(注意不是昵称)和密码--->客户端将信息递交给服务端--->服务端进行数据操作，并将结果回传给客户端--->用户得知登录情况
#####具体接口说明
| 参数名     | 必选   | 类型  |说明          |
| :--------: | :-----:| :----:|:------------:|
|uid         | yes    |String |用户唯一标识符|
|password    | yes    |String |密码          |
#####返回说明
| 返回值             |说明        |
| :--------:         | :---------:|
|\#user_not_valid    |用户不存在  |
|\#blocked_account   |账号已封禁  |
|\#password_invalid  |密码错误    |
|\#login_success     |登录成功    |
|\#exception_occurred|其他未知错误|
#####验证签名
千咲好温柔！
#####请求URL
等在上传云服后可以获取
#####请求方式
POST

####2.密码修改
#####具体描述
用户在手机上输入原密码和新密码，服务端接收到之后处理，并告诉用户具体的处理结果。
#####流程描述
用户选择功能，输入原密码和新密码--->客户端将数据递交给服务端--->服务端进行容错处理和数据库处理--->处理完毕，将处理结果返还给客户端--->客户端显示给用户看
#####具体接口说明
| 参数名     | 必选   | 类型  |说明          |
| :--------: | :-----:| :----:|:------------:|
| uid        | yes    | String|用户唯一标识符|
| oldpwd     | yes    | String|旧密码        |
| newpwd     | yes    | String|新密码        |
#####返回说明
| 返回值             |说明                          |
| :--------:         | :---------:                  |
|\#same_password     |原密码与现密码相同            |
|\#wrong_password    |原密码错误                    |
|\#set_success       |设置成功                      |
|\#other_wrong       |服务端处理时存在其他未知的错误|
|\#exception_occurred|catch到的exception的错误      |
#####验证签名
五十铃，可爱！
#####请求URL
等在上传云服后可以获取
#####请求方式
POST

####3.头像修改
#####具体描述
服务端会在用户注册时给与一张初始头像，用户若需要更改头像，在这之后可以根据自己需要更改头像。
#####流程描述
用户将图片连同相关信息选择上传--->客户端收到并递交给服务端--->服务端进行处理并返回结果--->客户端处理并将结果递交给用户
#####具体接口说明
| 参数名     | 必选   | 类型  |说明                    |
| :--------: | :-----:| :----:|:----------------------:|
|uid         |  yes   |String |用户的唯一标识，用于命名|
|extension   |  yes   |String |头像图片后缀名          |
头像图片的具体内容将使用Socket进行字节流传输
#####返回说明
| 返回值             |说明                        |
| :--------:         | :-----------------------:  |
|\#set_pic_success   |图片设置成功                |
|\#IOException_error |catch到的IOException的错误  |
#####验证签名
爱花，可爱！
#####请求URL：
等在上传云服后可以获取
#####请求方式
POST

####4.昵称修改
#####具体描述
用户可以对昵称进行修改。
#####流程描述
用户在客户端输入新昵称--->客户端将昵称和用户id提交给服务端--->服务端进行数据操作--->服务端将结果返回给客户端--->用户得知修改结果
#####具体接口说明
| 参数名     | 必选   | 类型  |说明                    |
| :--------: | :-----:| :----:|:----------------------:|
|uid         | yes    |String |用户唯一标识符          |
|nickname    | yes    |String |用户的新昵称            |
#####返回说明
| 返回值               |说明                        |
| :--------:           | :-----------------------:  |
|\#duplicate_nickname  |新昵称与旧昵称重复          |
|\#set_nickname_success|成功修改昵称                |
|\#exception_occurred  |原子操作或数据库操作出现问题|
|\#other_error         |其他未知错误                |
#####验证签名
美海小天使，可爱！
#####请求URL
等在上传云服后可以获取
#####请求方式
POST